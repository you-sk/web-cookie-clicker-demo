<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¯ãƒƒã‚­ãƒ¼ã‚¯ãƒªãƒƒã‚«ãƒ¼é¢¨ã‚²ãƒ¼ãƒ </title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: white;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        .main-game {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .shop {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .cookie {
            width: 200px;
            height: 200px;
            background: #D2691E;
            border-radius: 50%;
            margin: 20px auto;
            cursor: pointer;
            transition: transform 0.1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-touch-callout: none; /* iOS Safariç”¨ */
            -webkit-tap-highlight-color: transparent; /* ã‚¿ãƒƒãƒ—æ™‚ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’ç„¡åŠ¹åŒ– */
        }

        .cookie:hover {
            transform: scale(1.05);
        }

        .cookie:active {
            transform: scale(0.95);
        }

        .cookie::before {
            content: '';
            position: absolute;
            top: 20%;
            left: 30%;
            width: 15px;
            height: 15px;
            background: #8B4513;
            border-radius: 50%;
            box-shadow: 
                30px 10px 0 #8B4513,
                -10px 30px 0 #8B4513,
                20px 40px 0 #8B4513,
                50px 35px 0 #8B4513;
        }

        .counter {
            font-size: 2.5em;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 10px;
            font-size: 0.9em;
        }

        .upgrade {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 15px;
            margin: 5px 0;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s ease;
            font-size: 0.9em;
        }

        .upgrade:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .upgrade:disabled {
            background: rgba(255, 255, 255, 0.1);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .shop h3 {
            margin-top: 0;
            text-align: center;
            font-size: 1.2em;
        }

        .click-effect {
            position: absolute;
            color: #FFD700;
            font-weight: bold;
            font-size: 20px;
            pointer-events: none;
            animation: float-up 1s ease-out forwards;
        }

        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }

        .title {
            text-align: center;
            font-size: 2em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
            }
            
            .stats {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <h1 class="title">ğŸª ã‚¯ãƒƒã‚­ãƒ¼ã‚¯ãƒªãƒƒã‚«ãƒ¼é¢¨ã‚²ãƒ¼ãƒ </h1>
    
    <div class="game-container">
        <div class="main-game">
            <div class="counter" id="counter">0 ã‚¯ãƒƒã‚­ãƒ¼</div>
            
            <div class="cookie" id="cookie" draggable="false">ğŸª</div>
            
            <div class="stats">
                <div class="stat">
                    <strong>1ç§’ã‚ãŸã‚Š:</strong><br>
                    <span id="cps">0</span> ã‚¯ãƒƒã‚­ãƒ¼
                </div>
                <div class="stat">
                    <strong>ç·ã‚¯ãƒªãƒƒã‚¯æ•°:</strong><br>
                    <span id="totalClicks">0</span>
                </div>
                <div class="stat">
                    <strong>ã‚¯ãƒªãƒƒã‚¯å¨åŠ›:</strong><br>
                    <span id="clickPower">1</span>
                </div>
                <div class="stat">
                    <strong>è‡ªå‹•æ–½è¨­:</strong><br>
                    <span id="totalBuildings">0</span>
                </div>
                <div class="stat">
                    <strong>ç·ç”Ÿç”£æ•°:</strong><br>
                    <span id="totalProduced">0</span>
                </div>
                <div class="stat">
                    <strong>æ‰‹å‹•ç”Ÿç”£:</strong><br>
                    <span id="manualProduced">0</span>
                </div>
            </div>
        </div>

        <div class="shop">
            <h3>ğŸ›’ ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚·ãƒ§ãƒƒãƒ—</h3>
            
            <div style="background: rgba(255, 255, 255, 0.1); padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 0.8em;">
                ğŸ’¾ è‡ªå‹•ä¿å­˜æ©Ÿèƒ½ä»˜ã<br>
                10ç§’ã”ã¨ + è³¼å…¥æ™‚ã«è‡ªå‹•ä¿å­˜<br>
                ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å ±é…¬ã‚‚ã‚ã‚Šã¾ã™ï¼
            </div>
            
            <button class="upgrade" id="clickUpgrade">
                <strong>ã‚¯ãƒªãƒƒã‚¯å¼·åŒ–</strong><br>
                ã‚¯ãƒªãƒƒã‚¯å¨åŠ› +1<br>
                ã‚³ã‚¹ãƒˆ: <span id="clickUpgradeCost">10</span> ã‚¯ãƒƒã‚­ãƒ¼
            </button>
            
            <button class="upgrade" id="grandma">
                <strong>ãŠã°ã‚ã¡ã‚ƒã‚“</strong><br>
                1ç§’ã«1ã‚¯ãƒƒã‚­ãƒ¼ç”Ÿç”£<br>
                æ‰€æœ‰æ•°: <span id="grandmaCount">0</span><br>
                ã‚³ã‚¹ãƒˆ: <span id="grandmaCost">100</span> ã‚¯ãƒƒã‚­ãƒ¼
            </button>
            
            <button class="upgrade" id="farm">
                <strong>ã‚¯ãƒƒã‚­ãƒ¼è¾²å ´</strong><br>
                1ç§’ã«5ã‚¯ãƒƒã‚­ãƒ¼ç”Ÿç”£<br>
                æ‰€æœ‰æ•°: <span id="farmCount">0</span><br>
                ã‚³ã‚¹ãƒˆ: <span id="farmCost">500</span> ã‚¯ãƒƒã‚­ãƒ¼
            </button>
            
            <button class="upgrade" id="factory">
                <strong>ã‚¯ãƒƒã‚­ãƒ¼å·¥å ´</strong><br>
                1ç§’ã«20ã‚¯ãƒƒã‚­ãƒ¼ç”Ÿç”£<br>
                æ‰€æœ‰æ•°: <span id="factoryCount">0</span><br>
                ã‚³ã‚¹ãƒˆ: <span id="factoryCost">2000</span> ã‚¯ãƒƒã‚­ãƒ¼
            </button>
            
            <button class="upgrade" id="bank">
                <strong>ã‚¯ãƒƒã‚­ãƒ¼éŠ€è¡Œ</strong><br>
                1ç§’ã«100ã‚¯ãƒƒã‚­ãƒ¼ç”Ÿç”£<br>
                æ‰€æœ‰æ•°: <span id="bankCount">0</span><br>
                ã‚³ã‚¹ãƒˆ: <span id="bankCost">10000</span> ã‚¯ãƒƒã‚­ãƒ¼
            </button>
            
            <button class="upgrade" id="resetGame" style="background: rgba(255, 100, 100, 0.3); margin-top: 20px;">
                <strong>ğŸ”„ ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ</strong><br>
                å…¨ã¦ã®é€²æ—ã‚’å‰Šé™¤ã—ã¦æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™
            </button>
        </div>
    </div>

    <script>
        let cookies = 0;
        let clickPower = 1;
        let totalClicks = 0;
        let cps = 0;
        let totalProduced = 0;  // ç·ç”Ÿç”£æ•°ï¼ˆæ‰‹å‹•+è‡ªå‹•ï¼‰
        let manualProduced = 0; // æ‰‹å‹•ç”Ÿç”£æ•°ï¼ˆã‚¯ãƒªãƒƒã‚¯åˆ†ã®ã¿ï¼‰

        // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æƒ…å ±
        const upgrades = {
            clickUpgrade: { cost: 10, costMultiplier: 1.5 },
            grandma: { cost: 100, count: 0, cps: 1, costMultiplier: 1.15 },
            farm: { cost: 500, count: 0, cps: 5, costMultiplier: 1.15 },
            factory: { cost: 2000, count: 0, cps: 20, costMultiplier: 1.15 },
            bank: { cost: 10000, count: 0, cps: 100, costMultiplier: 1.15 }
        };

        // DOMè¦ç´ 
        const counterEl = document.getElementById('counter');
        const cookieEl = document.getElementById('cookie');
        const cpsEl = document.getElementById('cps');
        const totalClicksEl = document.getElementById('totalClicks');
        const clickPowerEl = document.getElementById('clickPower');
        const totalBuildingsEl = document.getElementById('totalBuildings');
        const totalProducedEl = document.getElementById('totalProduced');
        const manualProducedEl = document.getElementById('manualProduced');

        // ã‚¯ãƒƒã‚­ãƒ¼ã‚¯ãƒªãƒƒã‚¯
        cookieEl.addEventListener('click', (e) => {
            cookies += clickPower;
            totalClicks++;
            manualProduced += clickPower;
            totalProduced += clickPower;
            
            // ã‚¯ãƒªãƒƒã‚¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
            showClickEffect(e.clientX, e.clientY, `+${clickPower}`);
            
            updateDisplay();
        });

        // ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ç„¡åŠ¹åŒ–
        cookieEl.addEventListener('dblclick', (e) => {
            e.preventDefault();
        });

        cookieEl.addEventListener('contextmenu', (e) => {
            e.preventDefault();
        });

        // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹ã‚’ç„¡åŠ¹åŒ–
        cookieEl.addEventListener('dragstart', (e) => {
            e.preventDefault();
        });

        // ã‚¯ãƒªãƒƒã‚¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤º
        function showClickEffect(x, y, text) {
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.textContent = text;
            effect.style.left = x + 'px';
            effect.style.top = y + 'px';
            document.body.appendChild(effect);
            
            setTimeout(() => {
                document.body.removeChild(effect);
            }, 1000);
        }

        // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰è³¼å…¥
        function buyUpgrade(upgradeType) {
            const upgrade = upgrades[upgradeType];
            
            if (cookies >= upgrade.cost) {
                cookies -= upgrade.cost;
                
                if (upgradeType === 'clickUpgrade') {
                    clickPower++;
                    upgrade.cost = Math.floor(upgrade.cost * upgrade.costMultiplier);
                } else {
                    upgrade.count++;
                    upgrade.cost = Math.floor(upgrade.cost * upgrade.costMultiplier);
                }
                
                updateDisplay();
                updateCPS();
                saveGameState(); // è³¼å…¥æ™‚ã«ä¿å­˜
            }
        }

        // CPSï¼ˆ1ç§’ã‚ãŸã‚Šã‚¯ãƒƒã‚­ãƒ¼ï¼‰æ›´æ–°
        function updateCPS() {
            cps = 0;
            cps += upgrades.grandma.count * upgrades.grandma.cps;
            cps += upgrades.farm.count * upgrades.farm.cps;
            cps += upgrades.factory.count * upgrades.factory.cps;
            cps += upgrades.bank.count * upgrades.bank.cps;
        }

        // è¡¨ç¤ºæ›´æ–°
        function updateDisplay() {
            counterEl.textContent = `${cookies.toLocaleString()} ã‚¯ãƒƒã‚­ãƒ¼`;
            cpsEl.textContent = cps.toLocaleString();
            totalClicksEl.textContent = totalClicks.toLocaleString();
            clickPowerEl.textContent = clickPower.toLocaleString();
            totalProducedEl.textContent = totalProduced.toLocaleString();
            manualProducedEl.textContent = manualProduced.toLocaleString();
            
            const totalBuildings = upgrades.grandma.count + upgrades.farm.count + 
                                 upgrades.factory.count + upgrades.bank.count;
            totalBuildingsEl.textContent = totalBuildings.toLocaleString();

            // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®æ›´æ–°
            document.getElementById('clickUpgradeCost').textContent = upgrades.clickUpgrade.cost.toLocaleString();
            document.getElementById('clickUpgrade').disabled = cookies < upgrades.clickUpgrade.cost;

            // å»ºç‰©ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã®æ›´æ–°
            ['grandma', 'farm', 'factory', 'bank'].forEach(building => {
                const upgrade = upgrades[building];
                document.getElementById(`${building}Cost`).textContent = upgrade.cost.toLocaleString();
                document.getElementById(`${building}Count`).textContent = upgrade.count.toLocaleString();
                document.getElementById(building).disabled = cookies < upgrade.cost;
            });
        }

        // ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
        function resetGame() {
            if (confirm('æœ¬å½“ã«ã‚²ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ\nå…¨ã¦ã®é€²æ—ãŒå¤±ã‚ã‚Œã¾ã™ã€‚')) {
                // åŸºæœ¬å¤‰æ•°ãƒªã‚»ãƒƒãƒˆ
                cookies = 0;
                clickPower = 1;
                totalClicks = 0;
                cps = 0;
                totalProduced = 0;
                manualProduced = 0;
                
                // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æƒ…å ±ãƒªã‚»ãƒƒãƒˆ
                upgrades.clickUpgrade.cost = 10;
                upgrades.grandma.cost = 100;
                upgrades.grandma.count = 0;
                upgrades.farm.cost = 500;
                upgrades.farm.count = 0;
                upgrades.factory.cost = 2000;
                upgrades.factory.count = 0;
                upgrades.bank.cost = 10000;
                upgrades.bank.count = 0;
                
                updateDisplay();
                updateCPS();
                saveGameState(); // ãƒªã‚»ãƒƒãƒˆå¾Œã«ç©ºã®çŠ¶æ…‹ã‚’ä¿å­˜
            }
        }

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã®ä¿å­˜
        function saveGameState() {
            try {
                const gameData = {
                    cookies: cookies,
                    clickPower: clickPower,
                    totalClicks: totalClicks,
                    cps: cps,
                    totalProduced: totalProduced,
                    manualProduced: manualProduced,
                    upgrades: upgrades,
                    saveTime: Date.now()
                };
                localStorage.setItem('cookieClickerSave', JSON.stringify(gameData));
                console.log('ã‚²ãƒ¼ãƒ ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            } catch (error) {
                console.error('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
            }
        }

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã®èª­ã¿è¾¼ã¿
        function loadGameState() {
            try {
                const savedData = localStorage.getItem('cookieClickerSave');
                if (savedData) {
                    const gameData = JSON.parse(savedData);
                    
                    // ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒ
                    cookies = gameData.cookies || 0;
                    clickPower = gameData.clickPower || 1;
                    totalClicks = gameData.totalClicks || 0;
                    cps = gameData.cps || 0;
                    totalProduced = gameData.totalProduced || 0;
                    manualProduced = gameData.manualProduced || 0;
                    
                    // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æƒ…å ±ã®å¾©å…ƒ
                    if (gameData.upgrades) {
                        Object.keys(upgrades).forEach(key => {
                            if (gameData.upgrades[key]) {
                                upgrades[key] = { ...upgrades[key], ...gameData.upgrades[key] };
                            }
                        });
                    }
                    
                    updateDisplay();
                    updateCPS();
                    
                    const saveTime = new Date(gameData.saveTime);
                    console.log('ã‚²ãƒ¼ãƒ ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ (ä¿å­˜æ—¥æ™‚:', saveTime.toLocaleString(), ')');
                    
                    // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚é–“ã®è¨ˆç®—ã¨å ±é…¬
                    const offlineTime = Math.floor((Date.now() - gameData.saveTime) / 1000);
                    if (offlineTime > 60 && cps > 0) { // 1åˆ†ä»¥ä¸Šã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã€CPSãŒã‚ã‚‹å ´åˆ
                        const offlineEarnings = Math.floor(offlineTime * cps);
                        cookies += offlineEarnings;
                        totalProduced += offlineEarnings;
                        
                        const hours = Math.floor(offlineTime / 3600);
                        const minutes = Math.floor((offlineTime % 3600) / 60);
                        
                        alert(`ãŠç–²ã‚Œæ§˜ã§ã™ï¼\n${hours}æ™‚é–“${minutes}åˆ†ã®é–“ã« ${offlineEarnings.toLocaleString()} ã‚¯ãƒƒã‚­ãƒ¼ãŒç”Ÿç”£ã•ã‚Œã¾ã—ãŸï¼`);
                        updateDisplay();
                    }
                }
            } catch (error) {
                console.error('èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
            }
        }
        document.getElementById('clickUpgrade').addEventListener('click', () => buyUpgrade('clickUpgrade'));
        document.getElementById('grandma').addEventListener('click', () => buyUpgrade('grandma'));
        document.getElementById('farm').addEventListener('click', () => buyUpgrade('farm'));
        document.getElementById('factory').addEventListener('click', () => buyUpgrade('factory'));
        document.getElementById('bank').addEventListener('click', () => buyUpgrade('bank'));

        // è‡ªå‹•ç”Ÿç”£ï¼ˆ1ç§’ã”ã¨ï¼‰
        setInterval(() => {
            if (cps > 0) {
                cookies += cps;
                totalProduced += cps;
                updateDisplay();
            }
        }, 1000);

        // è‡ªå‹•ä¿å­˜ï¼ˆ10ç§’ã”ã¨ï¼‰
        setInterval(() => {
            saveGameState();
        }, 10000);

        // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        function initGame() {
            loadGameState(); // ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
            updateDisplay(); // è¡¨ç¤ºã®åˆæœŸåŒ–
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        window.addEventListener('load', initGame);

        // ãƒšãƒ¼ã‚¸ã‚’é–‰ã˜ã‚‹æ™‚ã«ä¿å­˜
        window.addEventListener('beforeunload', saveGameState);
    </script>
</body>
</html>
